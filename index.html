<!DOCTYPE html>
<meta charset="utf-8">
<title>Piensa</title>
<style>
@import url(static/maps.css);

.country {
  fill: #fff;
  stroke: #fff;
  stroke-width: .5px;
  stroke-linejoin: round;
}

.graticule {
  fill: none;
  stroke: #000;
  stroke-opacity: 0;
  stroke-width: .5px;
}

.graticule.outline {
  stroke: #ff7f0e;
  stroke-opacity: 1;
  stroke-width: 1.5px;
}

.graticule.mesh {
  stroke: #f00;
  stroke-opacity: 0;
  stroke-dasharray: 5,2;
  stroke-width: .5px;
}

.logo{
  width: 400px;
}

</style>
 <img class="logo" src="logo-piensa.png" alt="Logo Piensa"/>
 <h2>We are a technology studio that creates visualizations and tools<br>passionate about maps, open data and open source software.</h2>
<h1>Contact us at hello@piensa.co</h1>
<div id="map"></div>
<script src="static/d3.min.js"></script>
<script src="static/topojson.min.js"></script>
<script src="static/waterman.js"></script>
<script>

var width = 900,
    height = 600;

var rotate = [20, 0],
    projection = d3.geo.polyhedron.waterman()
      .scale(80)
      .translate([width / 2, height / 2])
      .rotate(rotate),
    rotation = d3.geo.rotation(rotate),
    color = d3.scale.category10(),
    graticule = d3.geo.graticule().minorStep([5, 5]);

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);

svg.append("path")
    .datum(graticule)
    .attr("class", "graticule")
    .attr("d", path);

svg.append("path")
    .datum({type: "MultiLineString", coordinates: projection.mesh.map(function(segment) {
      return segment.map(rotation.invert);
    })})
    .attr("class", "graticule mesh")
    .attr("d", path);

svg.append("path")
    .datum({type: "Sphere"})
    .attr("class", "graticule outline")
    .attr("d", path);

d3.json("static/world-110m.json", function(error, world) {
  var countries = topojson.feature(world, world.objects.countries).features,
      neighbors = topojson.neighbors(world.objects.countries.geometries);

  svg.selectAll(".country")
      .data(countries)
    .enter().insert("path", ".graticule")
      .attr("class", "country")
      .attr("d", path)
      .style("fill", function(d, i) { 
              // Hack to find Colombia and style it differently.
              if((neighbors[i][0] === 22) && (neighbors[i][1]===46)){
                      console.log(color);
                      return color(2);
              }else{
                  return color(0);
              };
      });
});

// Butterfly map in d3 taken from jasondavies.com on April 2015 -> https://www.jasondavies.com/maps/waterman-butterfly/

</script>

