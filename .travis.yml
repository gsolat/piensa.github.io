sudo: false

language: ruby

rvm:
- 2.2

branches:
  only:
  - blog-jekyll

script:
- bundle exec jekyll build
- bundle exec htmlproofer ./_site --disable-external

after_success:
- git clone https://$GH_REF
- cd $(basename ${GH_REF%.git})
- git config user.name "Travis-CI"
- git config user.email ${EMAIL}
- rsync -az --delete --exclude '.git*' ../_site/ .
- touch .nojekyll
- git add -A .
- git commit -m "Generated Jekyll Site by Travis CI - ${TRAVIS_BUILD_NUMBER}"
- git push -f "https://${DEPLOY_KEY}@${GH_REF}" ${TARGET_BRANCH} > /dev/null 2>&1

env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true
  - GH_REF: github.com/piensa/piensa.github.io.git
  - TARGET_BRANCH: master
  - secure: dQv/Z5kF2k6fFJYPZo8YYACTkNk9/lm81yyvOlZWGeYJTJK3rL63nvY/bGUviw50n7tJlt7WvnOBtbwjEt4pZITQKbw3BYcZKbOnpC2rmD7iQxgxOkCconcvdJxXG7qBZxHMfuo1QhXbuNBEXRDOeMh+fdcLQGAlyyfyd6T3FevjyCXEi1A37s2FxGONL+Zui2K2AtLsA6YOmk/jiImx18bW4/jLrkZ269IqpLq0+9Ja9TVQ9bxNgJfoOBzRVaQy+fPD4g/M18SRxOwaFFfcm7HEWVemsbMgzi1HWezoXnvT1HY4jO7MpSGAP7l+8ByKysByAayuXtq05bEDWmgh0nuRZfxlNrT4ZopRUssS/63VBzgeoR2osI6rt7VokW1udAK+uR0ilofwIotwMLYY3UdVRU6lm0DGgvKBIzxmTKDVP0CrSEk4sHh+0tCCkjUiQY+Oq1CTFX8Lq5LrPGwsRAYy8dHALPz46QRIzuAVH01Y27veHMvwfmRdrfnctFSDQo/zqt5jIz3pwtSi6woOYU09f7CRQ3Ff0QXbZiEa2zzvTJmoOSPrnTBJmrJqIsA7vZNziq+B7jJJwgxBeF+1mGW5sZsDQAsruwRKqVqp86fU6PTPOMuGxUbzgwbyWRsHZHYAiOJjU9DEz2eGbIpEXhQhw6+ddqFV5/BbNHrJm6Q=
  - secure: CCesh+YVG6/HELLqAYZ4PICqZubqfsdqMw90UqzjkgHS8LAaHEBIBzRZro5VTsN3xOKg3rOq2E1slkWarUB8Iic9IBtk0jnFfgzVO8M+6oy0rhXu1397LW3KOoY+OtqV3JOxBD+6Xyk/0o72ldiMO1N6lv7UGaBNH8vyh6PEX+/HQ2Cc19HB9PAPsnjBiGNweFFh446eeM9aAvNNGPjw3LLA8Epi0kEFAKSCTH+2A2khTjJxrEU4/J9gin5E8H7oyDkCprDYTVgNRPHrijvxOxFouaqfF8xiNONEYt3oo8sOlJXDh8LnM6ARJiPdbNyzG3R1cr5oKdibgmIEVmPw3tuuInLndbKF/qx4DrysY5HgRar6WLozVBfxihZpV3CU316NdS2shjhopdIRQhKf3nzkGZGDGsl2Gg0kBgL3jkMJssN7iDs9wOT8XobrakV2odnRjdPDe2NqCa7GSFM7VHNo+lpyQU073G+Gjbsm6R4muKceLN9YKKdo3HwDO7OCYNQrZZDUUXzGiR06CtdpznH2iwcIi9ffdg5rxNow39d5rIcPqnY61GxWuDKak5k/ZhIuxZhsyD7VviJp8cARpr4mLgX49O93diL2TBCl/OCZF32HGnzp7kfy58cmPPUkwCiZQS10mDKKlV50/vxDcHcc+vomY7MmCpNE724gXto=